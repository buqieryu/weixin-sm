(function(doc){ToSlideUp=function(el,src,options){var that=this;if(typeof src!='string'){throw new Error("传入的不是字符串或不存在");}
that.el=el;that.src=src;that.options={startLine:500,time:[500,100],scorllTo:0,scorllDuration:500,isShow:false,div:null,timer:null,Json:{},animationBool:false,isMove:false,height:null}
$.extend(that.options,options);}
ToSlideUp.prototype={init:function(){var that=this,istimer=false;that.options.height=$(window).height();that.options.div=$('<div/>',{id:'scorllUp'});that.options.div.html('<img width="100%"/>');that.options.div.css(that.options.Json).bind('touchstart',function(e){e.stopPropagation();if(!that.options.isMove){that.options.isMove=true;that.ScorllUp();}});that.options.div.find('img').attr({'src':that.src,'width':'100%'});$('body').append(that.options.div);window.onscroll=function(){if(istimer)return;istimer=true;window.setTimeout(function(){that.toggle();istimer=false;},40);}
that.toggle();},ScorllUp:function(){var that=this;var top=$(that.el).scrollTop();if(that.options.div.css('opacity')!=1){that.options.isMove=false;}else{var distance=top-that.options.scorllTo;var scorll=distance*20/that.options.scorllDuration;$(that.el).bind('touchstart',function(){that.options.animationBool=true;});that.options.timer=setInterval(function(){if(!that.options.animationBool){distance-=scorll;$(that.el).scrollTop(distance);if(distance<=0){clearInterval(that.options.timer);that.options.isMove=false;that.options.animationBool=false;that.options.timer=null;}}else{clearInterval(that.options.timer);that.options.isMove=false;that.options.animationBool=false;that.options.timer=null;}},20);}},toggle:function(){var that=this;var top=$(that.el).scrollTop();var clientHeight=document.body.scrollHeight;if(top+that.options.height==clientHeight)$(window).trigger('maxScorll');that.options.isShow=top>=that.options.startLine?true:false;if(that.options.isShow){that.options.div.show();}else{that.options.div.hide();}}}
window.ToSlideUp=ToSlideUp;})(document);